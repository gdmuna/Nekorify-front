<template>
    <div ref="introPageRoot" class="dark:bg-[#0E100F] w-[100dvw] mb-10">
        <scrollHint />
        <!-- Section 1 -->
        <section ref="section1" class="relative h-[100dvh] flex items-center justify-center pt-14
        bg-gray-100">
            <matrix class="absolute z-1 select-none" :width="setion1_width" :height="setion1_height"
                v-if="setion1_width > 0 && setion1_height > 0" />
            <!-- section ä¸»å†…å®¹ -->
            <div class="z-10 w-full flex flex-col md:flex-row
            items-center justify-evenly pointer-events-none *:pointer-events-auto">
                <!-- å·¦ä¾§å†…å®¹ -->
                <section1Left class="xl:mb-20 xl:ml-32 lg:ml-16 md:ml-4 mx-1" />
                <!-- å³ä¾§å†…å®¹ -->
                <section1Right class="xl:mr-32 lg:mr-24 md:mr-4 lg:ml-8 md:ml-4 mx-1" />
            </div>
            <div class="absolute bottom-0 left-1/2 flex items-center justify-between -translate-x-1/2
            mb-2 space-x-2 z-10 pointer-events-none">
                <div class="flex flex-col items-center justify-between font-extrabold whitespace-nowrap">
                    <p class="tracking-wider text-sm md:text-lg">æˆ‘è§é’å±±å¤šå¦©åªšï¼Œæ–™é’å±±è§æˆ‘åº”å¦‚æ˜¯</p>
                    <p class="text-xs md:text-lg">Comely hills I commune, a kindred soul in tune</p>
                </div>
            </div>
        </section>
        <!-- Section 2 -->
        <section class="relative bg-gray-200 dark:bg-[#0E100F]">
            <!-- èƒŒæ™¯è¿‡æ¸¡ -->
            <div class="absolute top-0 left-0 w-screen xl:h-72 h-64 z-10 pointer-events-none gradientBg" />
            <!-- section ä¸»å†…å®¹ -->
            <div class="xl:pt-72 pt-64">
                <!-- section title -->
                <titleBlock class="md:ml-8 ml-4" titleA="WHO" titleA_color="#F5C7F8" titleB="WE ARE"
                    titleB_color="#EF8D36" />
                <div class="flex flex-col items-center font-bold lg:my-32 md:my-16 my-8">
                    <h1 class="lg:text-9xl md:text-[5rem] text-5xl whitespace-nowrap">
                        WE ARE THE
                    </h1>
                    <div ref="section2_title_1"
                        class="relative w-full lg:h-[4.5rem] md:h-[3rem] h-[1.875rem] mt-4 overflow-hidden
                    *:whitespace-nowrap lg:*:text-7xl md:*:text-5xl text-3xl lg:*:space-x-6 md:*:space-x-4 *:space-x-2">
                        <h2 ref="section2_dynamicTitle_1" class="flex items-center absolute left-1/2 -translate-x-1/2">
                            <span class="block">DEVELOPER</span>
                            <BrainCircuit class="lg:size-12 md:size-10 size-6" />
                        </h2>
                        <h2 ref="section2_dynamicTitle_2" class="flex items-center absolute left-1/2 -translate-x-1/2">
                            <span class="block">ARCHITECT</span>
                            <Puzzle class="lg:size-12 md:size-10 size-6" />
                        </h2>
                        <h2 ref="section2_dynamicTitle_3" class="flex items-center absolute left-1/2 -translate-x-1/2">
                            <span class="block">EXPLORER</span>
                            <Satellite class="lg:size-12 md:size-10 size-6" />
                        </h2>
                    </div>
                </div>
                <div class="flex flex-col xl:mt-40 mt-16 ml-8 mr-2 xl:mx-6">
                    <!-- card-1 -->
                    <div class="relative">
                        <div ref="lottieContainerA" v-if="isXlDesktop" class="size-[42rem] absolute top-0 left-0"></div>
                        <macWindow border enterAnimate :enableSplitText="!isMobile"
                            class="xl:!w-128 xl:mr-20 xl:ml-auto md:mx-auto">
                            <template #TR>
                                <div class="flex-1"></div>
                                <img src="/src/assets/NA-LOGO/gdmuna-logo_gradient.svg" alt="" class="size-8">
                                <span class="text-lg Association-NA">GDMU-NA</span>
                            </template>
                            <template #main>
                                <div class="flex-1 flex justify-between items-center w-full h-full">
                                    <img src="/src/assets/NA-LOGO/gdmuna-logo_gradient.svg" alt=""
                                        class="xl:size-32 md:size-36 size-20">
                                    <div class="bg-[#595959] w-[1px] self-stretch mr-4" />
                                    <div class="flex-1 xl:text-lg md:text-2xl split-text">
                                        ç½‘ç»œåä¼šï¼ˆGDMU-NAï¼‰â€‹â€‹ä¸“æ³¨â€‹â€‹å…¨æ ˆå¼€å‘ä¸ç³»ç»Ÿè¿ç»´â€‹â€‹ï¼Œæˆå‘˜é€šè¿‡å¼€æºé¡¹ç›®å®è·µâ€‹â€‹å‰åç«¯å¼€å‘ã€æ•°æ®åº“æ„å»ºä¸æœåŠ¡å™¨ç®¡ç†â€‹â€‹ï¼Œæ”¯æ’‘æ ¡å›­æ•°å­—åŒ–æœåŠ¡ï¼ˆå¦‚ç½‘åŠå¤§å…ï¼‰ã€‚
                                    </div>
                                </div>
                            </template>
                        </macWindow>
                    </div>
                    <!-- card-2 -->
                    <div class="relative xl:mt-100 mt-6">
                        <macWindow border enterAnimate :enableSplitText="!isMobile" class="xl:!w-128 xl:ml-20">
                            <template #TR>
                                <div class="flex-1"></div>
                                <img src="/src/assets/ACM-LOGO/ACM-LOGO 1.svg" alt="" class="size-8">
                                <span class="text-lg Association-ACM">GDMU-ACM</span>
                            </template>
                            <template #main>
                                <div class="flex-1 flex justify-between items-center w-full h-full">
                                    <img src="/src/assets/ACM-LOGO/ACM-LOGO 1.svg" alt="" class="xl:size-32 md:size-36 size-20">
                                    <div class="bg-[#595959] w-[1px] self-stretch mr-4" />
                                    <div class="flex-1 xl:text-lg md:text-2xl split-text">
                                        â€‹â€‹ACMåä¼šï¼ˆGDMU-ACMï¼‰â€‹â€‹ä¸»æ”»â€‹â€‹ç®—æ³•ä¸AIåº”ç”¨â€‹â€‹ï¼Œé™¤ç³»ç»Ÿè®­ç»ƒæ•°æ®ç»“æ„å’Œç«èµ›ç¼–ç¨‹å¤–ï¼Œæ›´æ·±åŒ–â€‹â€‹æ·±åº¦å­¦ä¹ ä¸è®¡ç®—æœºè§†è§‰é¢†åŸŸâ€‹â€‹ï¼ˆå«ç›®æ ‡æ£€æµ‹æ¨¡å‹å¦‚YOLOçš„å®æˆ˜è®­ç»ƒï¼‰ï¼ŒåŸ¹å…»å‰æ²¿æŠ€æœ¯ç ”ç©¶èƒ½åŠ›ã€‚
                                    </div>
                                </div>
                            </template>
                        </macWindow>
                        <div ref="lottieContainerB" v-if="isXlDesktop"
                            class="size-[42rem] absolute top-0 right-0 -translate-y-1/2">
                        </div>
                    </div>
                    <!-- card-3 -->
                    <div class="flex items-center justify-evenly xl:mt-48 mt-6">
                        <img ref="cat_smile" src="/src/assets/çŒ«-ç¬‘.webp" alt="" class="size-64" v-if="isXlDesktop">
                        <macWindow border enterAnimate :enableSplitText="!isMobile" class="xl:!w-128">
                            <template #TR>
                                <div class="flex-1"></div>
                                <img src="/src/assets/NA-LOGO/gdmuna-logo_gradient.svg" alt="" class="size-8">
                                <div class="bg-[#595959] w-[1px] self-stretch" />
                                <img src="/src/assets/ACM-LOGO/ACM-LOGO 1.svg" alt="" class="size-7">
                            </template>
                            <template #main>
                                <div class="flex-1 flex items-center w-full h-full xl:text-xl md:text-2xl">
                                    <div class="flex-1 ml-2 split-text">
                                        <span
                                            class="no-split card-3-1 text-[#0E100F] text-center rounded inline-block px-2 font-extrabold">
                                            äºŒè€…åˆ†å·¥åä½œ
                                        </span>
                                        <span class="!inline">
                                            ç½‘ç»œåä¼šé”»é€ â€‹â€‹å·¥ç¨‹å®ç°èƒ½åŠ›â€‹â€‹ï¼ŒACMåä¼šé”¤ç‚¼â€‹â€‹ç®—æ³•ä¸æ¨¡å‹ç ”å‘èƒ½åŠ›â€‹â€‹ï¼Œå…±åŒæ„å»ºè¦†ç›–â€œâ€‹â€‹ç³»ç»Ÿå¼€å‘-æ ¸å¿ƒç®—æ³•-AIåº”ç”¨â€‹â€‹â€çš„å…¨é“¾æ¡æŠ€æœ¯ç”Ÿæ€ï¼Œèµ‹èƒ½æˆå‘˜å‘å…¨æ ˆå·¥ç¨‹å¸ˆã€ç®—æ³•ç ”ç©¶å‘˜ç­‰é«˜é˜¶æ–¹å‘å‘å±•ã€‚
                                        </span>
                                    </div>
                                </div>
                            </template>
                        </macWindow>
                        <img ref="fish_smile" src="/src/assets/é±¼-ç¬‘.webp" alt="" class="size-64" v-if="isXlDesktop">
                    </div>
                </div>
            </div>
        </section>
        <!-- Section 3 -->
        <section class="bg-gray-100 dark:bg-[#0E100F]">
            <!-- section ä¸»å†…å®¹ -->
            <div ref="section3_main" class="xl:pt-36 md:pt-10">
                <!-- section æ¨ªå‘æ»šåŠ¨ä¸»å†…å®¹ -->
                <div ref="section3_scrollMain" class="relative w-full xl:h-[100dvh] md:pt-14 pt-8 flex flex-col">
                    <!-- section title -->
                    <div class="flex items-center justify-between">
                        <titleBlock class="ml-8 mt-8" titleA="WHAT SKILLS" titleA_color="#9C95F8"
                            titleB="CAN YOU MASTER" titleB_color="#53B7DE" />
                        <div v-if="isDesktop" ref="section3_progressDivs"
                            class="will-change-transform font-bold mr-8 flex flex-col">
                            <div class="text-2xl flex justify-between">
                                <p>{{ section3_progressText }}</p>
                                <p>{{ section3_scrollProgressPercent }}</p>
                            </div>
                            <div class="relative overflow-hidden truncate break-all">
                                <span v-for="(_, index) in Array.from({ length: 15 })" :key="index">â–‘â–‘â–‘</span>
                                <div ref="section3_progressBlock"
                                    class="absolute top-0 w-full h-full section3-progressBlock">
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <p>{{ section3_scrollLengthProgressPx }}</p>
                                <p>Speed: {{ section3_scrollVelocity }}px / s</p>
                            </div>
                        </div>
                    </div>
                    <!-- æ¨ªå‘æ»šåŠ¨å®¹å™¨ -->
                    <div ref="section3_scrollContainer" class="w-full h-full flex xl:flex-row flex-col items-center">
                        <!-- æ¨ªå‘æ»šåŠ¨å†…å®¹ - title -->
                        <div
                            class="h-full w-fit flex flex-col items-start justify-evenly space-y-8 xl:text-7xl md:text-5xl text-3xl font-bold xl:ml-32 xl:my-0 my-8 whitespace-nowrap">
                            <h1 class="will-change-transform">
                                <span class="md:mr-8 mr-4">NOT A</span>
                                <span
                                    class="section-3-title-1-block title-block rounded-lg text-[#0E100F] inline-block md:px-8 md:py-2 px-4 py-1">FACTORY</span>
                            </h1>
                            <h1 class="xl:ml-24 will-change-transform">
                                <span class="md:mr-8 mr-4">BUT A</span>
                                <span
                                    class="section-3-title-2-block title-block rounded-lg text-[#0E100F] inline-block md:px-8 md:py-2 px-4 py-1">FOUNDRY</span>
                            </h1>
                        </div>
                        <!-- æ¨ªå‘æ»šåŠ¨å†…å®¹ - card -->
                        <!-- ä¸ºä»€ä¹ˆä¸ä½¿ç”¨ v-for ? -->
                        <!-- æ¯å¼ å¡ç‰‡mainåŒºåŸŸä¸Šéƒ¨çš„logoä¸­ç©ºç™½åŒºåŸŸæ‰€å æ¯”ä¾‹éƒ½ä¸åŒï¼Œä¸ºäº†è§†è§‰ä¸€è‡´æ€§ï¼Œéœ€è¦å¾®è°ƒï¼Œæ•…ä¸ä½¿ç”¨ v-for -->
                        <div ref="section3_cards"
                            class="xl:ml-32 xl:flex xl:flex-row grid grid-cols-1 md:grid-cols-2 gap-10 xl:space-x-16 space-y-2
                        xl:mx-0 xl:pl-0 pl-4 pr-8 *:break-all xl:*:!w-110 xl:*:!h-90 md:*:!h-80 lg:overflow-visible overflow-hidden md:pb-0 pb-2">
                            <macWindow border>
                                <template #TR>
                                    <div class="flex-1"></div>
                                    <img src="/src/assets/NA-LOGO/gdmuna-logo_gradient.svg" alt="" class="md:size-8 size-6">
                                    <span class="text-lg Association-NA">GDMU-NA</span>
                                </template>
                                <template #main>
                                    <div class="flex flex-col items-center justify-between h-full w-full">
                                        <div
                                            class="flex items-center justify-center border-b-1 border-[#595959] mx-16 w-full">
                                            <img src="/src/assets/æŠ€æœ¯æ ˆLOGO/C++-logo.svg" alt="" class="xl:size-20 size-16">
                                            <span class="code-cpp xl:text-3xl text-xl font-bold">C++</span>
                                        </div>
                                        <p
                                            class="flex-1 flex items-center justify-center p-4 md:text-lg font-bold tracking-wider whitespace-pre-wrap">
                                            ä¸­ä½çº§è¯­è¨€ï¼Œç»§æ‰¿Cçš„é«˜æ•ˆæ€§å¹¶æ”¯æŒé¢å‘å¯¹è±¡ã€‚æä¾›å†…å­˜æ“ä½œèƒ½åŠ›ï¼Œé€‚ç”¨ç³»ç»Ÿç¼–ç¨‹ã€æ¸¸æˆå¼•æ“ï¼ˆUnrealï¼‰åŠé«˜æ€§èƒ½è®¡ç®—åœºæ™¯ã€‚
                                        </p>
                                    </div>
                                </template>
                            </macWindow>
                            <macWindow border>
                                <template #TR>
                                    <div class="flex-1"></div>
                                    <img src="/src/assets/NA-LOGO/gdmuna-logo_gradient.svg" alt="" class="md:size-8 size-6">
                                    <span class="text-lg Association-NA">GDMU-NA</span>
                                </template>
                                <template #main>
                                    <div class="flex flex-col items-center justify-between h-full w-full">
                                        <div
                                            class="flex items-center justify-center border-b-1 border-[#595959] px-14 py-2 space-x-2 w-full">
                                            <img src="/src/assets/æŠ€æœ¯æ ˆLOGO/javascript.svg" alt="" class="xl:size-16 size-12">
                                            <span class="code-JS xl:text-3xl text-xl font-bold">JavaScript</span>
                                        </div>
                                        <p
                                            class="flex-1 flex items-center justify-center p-4 md:text-lg font-bold tracking-wider whitespace-pre-wrap">
                                            æµè§ˆå™¨ç«¯çš„è„šæœ¬è¯­è¨€ï¼Œå®ç°ç½‘é¡µåŠ¨æ€äº¤äº’ï¼ˆå¦‚è¡¨å•éªŒè¯ã€å†…å®¹æ›´æ–°ï¼‰ã€‚æ”¯æŒå¼‚æ­¥è¯·æ±‚ï¼ˆAJAXï¼‰ï¼Œç°ä¹Ÿå¯é€šè¿‡Node.jsè¿è¡ŒäºæœåŠ¡å™¨ç«¯ã€‚
                                        </p>
                                    </div>
                                </template>
                            </macWindow>
                            <macWindow border>
                                <template #TR>
                                    <div class="flex-1"></div>
                                    <img src="/src/assets/NA-LOGO/gdmuna-logo_gradient.svg" alt="" class="md:size-8 size-6">
                                    <span class="text-lg Association-NA">GDMU-NA</span>
                                </template>
                                <template #main>
                                    <div class="flex flex-col items-center justify-between h-full w-full">
                                        <div
                                            class="flex items-center justify-center border-b-1 border-[#595959] px-14 py-2 space-x-2 w-full">
                                            <img src="/src/assets/æŠ€æœ¯æ ˆLOGO/vue-js.svg" alt="" class="xl:size-16 size-12">
                                            <span class="brand-vue xl:text-3xl text-xl font-bold">VUE</span>
                                        </div>
                                        <p
                                            class="flex-1 flex items-center justify-center p-4 md:text-lg font-bold tracking-wider whitespace-pre-wrap">
                                            æ¸è¿›å¼å‰ç«¯æ¡†æ¶ï¼Œè½»é‡æ˜“ä¸Šæ‰‹ã€‚é‡‡ç”¨ç»„ä»¶åŒ–è®¾è®¡ï¼Œæ”¯æŒåŒå‘æ•°æ®ç»‘å®šï¼Œç®€åŒ–å•é¡µé¢åº”ç”¨ï¼ˆSPAï¼‰å¼€å‘ï¼Œç”Ÿæ€ä¸°å¯Œï¼ˆVuex/Vue Routerï¼‰ã€‚
                                        </p>
                                    </div>
                                </template>
                            </macWindow>
                            <macWindow border>
                                <template #TR>
                                    <div class="flex-1"></div>
                                    <img src="/src/assets/NA-LOGO/gdmuna-logo_gradient.svg" alt="" class="md:size-8 size-6">
                                    <span class="text-lg Association-NA">GDMU-NA</span>
                                </template>
                                <template #main>
                                    <div class="flex flex-col items-center justify-between h-full w-full">
                                        <div
                                            class="flex items-center justify-center border-b-1 border-[#595959] px-14 space-x-2 w-full">
                                            <img src="/src/assets/æŠ€æœ¯æ ˆLOGO/express-js.svg" alt="" class="xl:size-20 size-16">
                                            <span class="brand-express xl:text-3xl text-xl font-bold">Express</span>
                                        </div>
                                        <p
                                            class="flex-1 flex items-center justify-center p-4 md:text-lg font-bold tracking-wider whitespace-pre-wrap">
                                            Node.jsçš„Webæ¡†æ¶ï¼Œæä¾›è·¯ç”±ã€ä¸­é—´ä»¶ç­‰å·¥å…·ã€‚ä»¥ç®€çº¦çµæ´»è‘—ç§°ï¼Œå¯å¿«é€Ÿæ„å»ºRESTful APIåŠæœåŠ¡å™¨ç«¯åº”ç”¨ã€‚
                                        </p>
                                    </div>
                                </template>
                            </macWindow>
                            <macWindow border>
                                <template #TR>
                                    <div class="flex-1"></div>
                                    <img src="/src/assets/NA-LOGO/gdmuna-logo_gradient.svg" alt="" class="md:size-8 size-6">
                                    <span class="text-lg Association-NA">GDMU-NA</span>
                                </template>
                                <template #main>
                                    <div class="flex flex-col items-center justify-between h-full w-full">
                                        <div
                                            class="flex items-center justify-center border-b-1 border-[#595959] px-14 space-x-4 w-full">
                                            <img src="/src/assets/æŠ€æœ¯æ ˆLOGO/mysql-logo.svg" alt="" class="xl:size-20 size-16">
                                            <span class="brand-mysql xl:text-3xl text-xl font-bold">MySQL</span>
                                        </div>
                                        <p
                                            class="flex-1 flex items-center justify-center p-4 md:text-lg font-bold tracking-wider whitespace-pre-wrap">
                                            å¼€æºå…³ç³»å‹æ•°æ®åº“ï¼Œä½¿ç”¨SQLç®¡ç†æ•°æ®ã€‚æ”¯æŒACIDäº‹åŠ¡ï¼Œé€‚ç”¨äºä¸­å°å‹åº”ç”¨ï¼Œå¸¸ä¸LAMPï¼ˆLinux+Apache+MySQL+PHPï¼‰æ ˆæ­é…ã€‚
                                        </p>
                                    </div>
                                </template>
                            </macWindow>
                            <macWindow border>
                                <template #TR>
                                    <div class="flex-1"></div>
                                    <img src="/src/assets/ACM-LOGO/ACM-LOGO 1.svg" alt="" class="md:size-8 size-5">
                                    <span class="text-lg Association-ACM">GDMU-ACM</span>
                                </template>
                                <template #main>
                                    <div class="flex flex-col items-center justify-between h-full w-full">
                                        <div
                                            class="flex items-center justify-center border-b-1 border-[#595959] px-14 py-2 space-x-2 w-full">
                                            <img src="/src/assets/æŠ€æœ¯æ ˆLOGO/python.svg" alt="" class="xl:size-16 size-12">
                                            <span class="code-python xl:text-3xl text-xl font-bold">Python</span>
                                        </div>
                                        <p
                                            class="flex-1 flex items-center justify-center p-4 md:text-lg font-bold tracking-wider whitespace-pre-wrap">
                                            è§£é‡Šå‹é«˜çº§è¯­è¨€ï¼Œè¯­æ³•ç®€æ´æ˜“è¯»ï¼Œæ”¯æŒå¤šèŒƒå¼ç¼–ç¨‹ã€‚å¹¿æ³›åº”ç”¨äºWebåç«¯ï¼ˆDjangoï¼‰ã€æ•°æ®åˆ†æï¼ˆPandasï¼‰ã€AIï¼ˆPyTorchï¼‰ç­‰é¢†åŸŸã€‚
                                        </p>
                                    </div>
                                </template>
                            </macWindow>
                            <macWindow border>
                                <template #TR>
                                    <div class="flex-1"></div>
                                    <img src="/src/assets/ACM-LOGO/ACM-LOGO 1.svg" alt="" class="md:size-8 size-5">
                                    <span class="text-lg Association-ACM">GDMU-ACM</span>
                                </template>
                                <template #main>
                                    <div class="flex flex-col items-center justify-between h-full w-full">
                                        <div
                                            class="flex items-center justify-center border-b-1 border-[#595959] px-14 py-2 space-x-2 w-full">
                                            <img src="/src/assets/æŠ€æœ¯æ ˆLOGO/pytorch.svg" alt="" class="xl:size-16 size-12">
                                            <span class="brand-pytorch xl:text-3xl text-xl font-bold">PyTorch</span>
                                        </div>
                                        <p
                                            class="flex-1 flex items-center justify-center p-4 md:text-lg font-bold tracking-wider whitespace-pre-wrap">
                                            Pythonæ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œç”±Facebookå¼€å‘ã€‚åŠ¨æ€è®¡ç®—å›¾ä¾¿äºè°ƒè¯•ï¼Œæä¾›è‡ªåŠ¨æ±‚å¯¼åŠŸèƒ½ï¼Œå¹¿æ³›ç”¨äºç ”ç©¶ï¼ˆå¦‚YOLOæ¨¡å‹è®­ç»ƒï¼‰ä¸ç”Ÿäº§ã€‚
                                        </p>
                                    </div>
                                </template>
                            </macWindow>
                            <macWindow border>
                                <template #TR>
                                    <div class="flex-1"></div>
                                    <img src="/src/assets/ACM-LOGO/ACM-LOGO 1.svg" alt="" class="md:size-8 size-5">
                                    <span class="text-lg Association-ACM">GDMU-ACM</span>
                                </template>
                                <template #main>
                                    <div class="flex flex-col items-center justify-between h-full w-full">
                                        <div
                                            class="flex items-center justify-center border-b-1 border-[#595959] px-14 py-2 space-x-4 w-full">
                                            <img src="/src/assets/æŠ€æœ¯æ ˆLOGO/yolo.svg" alt="" class="xl:size-16 size-12">
                                            <span class="brand-yolo xl:text-3xl text-xl font-bold">YOLO</span>
                                        </div>
                                        <p
                                            class="flex-1 flex items-center justify-center p-4 md:text-lg font-bold tracking-wider whitespace-pre-wrap">
                                            å®æ—¶ç›®æ ‡æ£€æµ‹ç®—æ³•ï¼ˆYou Only Look Onceï¼‰ã€‚å•æ¬¡å‰å‘ä¼ æ’­é¢„æµ‹å¤šç›®æ ‡ä½ç½®ä¸ç±»åˆ«ï¼Œé€Ÿåº¦æå¿«ï¼Œé€‚ç”¨è‡ªåŠ¨é©¾é©¶ã€å®‰é˜²ç›‘æ§ç­‰åœºæ™¯ã€‚
                                        </p>
                                    </div>
                                </template>
                            </macWindow>
                            <!-- card åçš„æ–‡å­— -->
                            <p ref="section3_PTag" class="flex items-center justify-center xl:text-7xl md:text-5xl text-3xl font-bold
                        whitespace-nowrap will-change-transform md:col-span-2">
                                AND MORE...
                            </p>
                        </div>
                        <div v-if="isMobile" ref="section3_cards_toggle"
                            class="mt-8 relative overflow-hidden text-xl text-[#0E100F] font-bold py-2 pl-4 pr-2 bg-[#23d1dd] rounded-lg"
                            @click="section3CardsManager.toggleStatus">
                            <div class="flex items-center justify-center">
                                <span>å±•å¼€</span>
                                <ChevronsDown class="size-6" />
                            </div>
                            <div class="flex items-center justify-center absolute top-1/2 -translate-y-1/2">
                                <span>æ”¶èµ·</span>
                                <ChevronsUp class="size-6" />
                            </div>
                        </div>
                    </div>
                </div>
                <div ref="section_3_title_3"
                    class="w-full flex flex-col items-center justify-center xl:text-7xl md:text-5xl text-2xl xl:pt-16 md:pt-0 pt-16 font-bold whitespace-nowrap will-change-transform">
                    <div>
                        <h1>NEXT</h1>
                        <h1>
                            <span class="md:mr-8 mr-2">YOUR TURN TO</span>
                            <span class="section-3-title-3-block title-block text-[#0E100F]
                            inline-block md:px-8 md:py-2 px-4 py-1 rounded-lg">
                                FORGE
                            </span>
                        </h1>
                    </div>
                </div>
            </div>
        </section>
        <!-- Section 4 -->
        <section class="bg-gray-200 dark:bg-[#0E100F] pb-20">
            <!-- section ä¸»å†…å®¹ -->
            <div class="xl:pt-36 pt-18">
                <!-- section title -->
                <titleBlock class="ml-8" titleA="QUESTION" titleA_color="#27AFA5" titleB="AND ANSWER"
                    titleB_color="#119DEC" />
                <QA class="xl:mt-32 mt-18 md:mx-8 mx-4" />
                <h1
                    class="section-4-title-1 xl:text-7xl md:text-5xl text-[2rem] font-bold my-16 space-y-0 md:space-y-8 whitespace-nowrap flex flex-col">
                    <p class="ml-8 md:ml-20 xl:ml-40">WHERE FANTASY</p>
                    <p class="ml-auto mr-8 md:mr-20 xl:mr-40">BECOMES REALITY</p>
                </h1>
                <section4Terminal />
            </div>
        </section>
        <!-- Section 5 -->
        <section class="bg-gray-100 dark:bg-[#0E100F]">
            <div class="xl:pt-24 md:pt-16 pt-8">
                <!-- section ä¸»å†…å®¹ -->
                <h1 class="md:text-6xl text-4xl text-center font-bold">å¼€å‘è€…</h1>
                <!-- è´¡çŒ®è€…åå• -->
                <div class="w-full grid md:grid-cols-2 grid-cols-1 xl:gap-20 gap-10 justify-items-center
                md:mt-24 mt-8 xl:pl-14 xl:pr-16 md:pl-4 md:pr-8 pl-2 pr-8">
                    <macWindow border class="md:!h-full h-64 w-full">
                        <template #TR>
                            <div class="flex-1" />
                            <outlineText text="GitHubä¸»é¡µ" bottomLineClass="!mt-0" class="hover:text-[#119DEC] md:text-[#FEFCE4] text-[#119DEC]
                            transition-colors duration-300 pb-2 md:pb-0" lineColor="#119DEC" transitionLineColor
                                :keepInEnd="isMobile" @click="openInNewTab('https://github.com/kz2006a')">
                                <ExternalLink class="size-4 translate-y-0.5" />
                            </outlineText>
                        </template>
                        <template #main>
                            <div class="flex-1 flex items-center">
                                <div class="flex h-full flex-col items-center justify-center
                                space-y-4 border-r-1 border-r-[#595959] px-4">
                                    <img src="/src/assets/å¼€å‘è€…å¤´åƒ/Almighty.jpg" alt="" class="md:size-24 size-16 rounded-full">
                                    <p class="md:text-2xl text-lg whitespace-nowrap overflow-ellipsis">Almighty</p>
                                </div>
                                <div class="flex-1 h-full flex items-center ml-4 min-w-1/3">
                                    <p class="md:text-lg text-sm break-all">
                                        ç¬¬22å±Š GDMU-NA
                                        å‰¯ä¼šé•¿ã€‚æ‘„å½±ã€æ— çº¿ç”µï¼ˆBG7MQUå¯æ¢å¡ï¼‰ï¼Œä¼šä¸€ç‚¹å°ç”µç„Šï¼Œå‰åç«¯å¼€å‘ä¸€æŠŠæŠ“ï¼ˆç°åœ¨å¤´å‘è¿˜å¾ˆå¤šï¼‰ã€‚åŸæœ¬å­¦ç”Ÿç‰©ï¼Œç»“æœä¸€ä¸å°å¿ƒæ‰è¿›äº†ä»£ç çš„å‘ï¼ˆåˆ«é—®ï¼Œé—®å°±æ˜¯ç”Ÿç‰©å¤ªéš¾ï¼‰ã€‚
                                        å…´è¶£å¹¿æ³›ï¼Œä»€ä¹ˆéƒ½æƒ³ç©ï¼Œæ— ä¸€ç²¾é€šã€‚
                                        <span class="block text-center">â€œğŸ˜‹äººç”Ÿå¾—æ„é¡»å°½æ¬¢ï¼Œè«ä½¿é‡‘æ¨½ç©ºå¯¹æœˆğŸ˜‹â€</span>
                                    </p>
                                </div>
                            </div>
                        </template>
                    </macWindow>
                    <macWindow border class="md:!h-full h-64 w-full">
                        <template #TR>
                            <div class="flex-1" />
                            <outlineText text="GitHubä¸»é¡µ" bottomLineClass="!mt-0" class="hover:text-[#119DEC] md:text-[#FEFCE4] text-[#119DEC]
                            transition-colors duration-300 pb-2 md:pb-0" lineColor="#119DEC" transitionLineColor
                                :keepInEnd="isMobile" @click="openInNewTab('https://github.com/FOV-RGT')">
                                <ExternalLink class="size-4 translate-y-0.5" />
                            </outlineText>
                        </template>
                        <template #main>
                            <div class="flex-1 flex items-center">
                                <div class="flex h-full flex-col items-center justify-center
                                space-y-4 border-r-1 border-r-[#595959] px-4">
                                    <img src="/src/assets/å¼€å‘è€…å¤´åƒ/FOV-RGT.jpg" alt="" class="md:size-24 size-16 rounded-full">
                                    <p class="md:text-2xl text-lg whitespace-nowrap overflow-ellipsis">FOV-RGT</p>
                                </div>
                                <div class="flex-1 h-full flex items-start ml-4 min-w-1/3 flex-col">
                                    <p class="md:text-lg text-sm">
                                        Cialloï½(âˆ ãƒ»Ï‰< )âŒ’â˜† </p>
                                            <p class="md:text-lg text-sm">
                                                ç¬¬22å±Š GDMU-NA BIéƒ¨éƒ¨é•¿ï¼Œå…¨æ ˆå¼€å‘è€…ï¼Œç›®å‰å¤´å‘è¿˜å¾ˆå¤šğŸ¤“
                                            </p>
                                            <p class="md:text-lg text-sm">
                                                å–œæ¬¢çœ‹ç•ªæ‰“æ¸¸æˆï¼Œè¿˜ä¼šç‚¹ç”µå‰ä»–ï¼Œåªå¯æƒœæŸ“ä¸Šè“è‰²åŸç¥ï¼ˆVSCodeï¼‰åå°±å¾ˆå°‘ç©ºé—²æ—¶é—´äº†ğŸ˜­
                                            </p>
                                            <!-- <p class="md:text-lg text-sm">
                                        å‰ç«¯å¸¸ç”¨ Vue 3 + TypeScriptï¼Œæ­é… Shadcn å’Œ Tailwind å†™ç•Œé¢ï¼›åç«¯ä¹Ÿèƒ½æ•´ï¼ŒExpress + Sequelize å†™ APIï¼ŒMySQLã€Redis éƒ½æ‘¸è¿‡ğŸ§
                                    </p> -->
                                            <p class="md:text-lg text-sm">
                                                å•¥éƒ½æƒ³åšï¼šå‰åç«¯ã€ç»„ä¹é˜Ÿã€åµŒå…¥å¼ã€æ— çº¿ç”µã€æ‘„å½±ã€è§†é¢‘å‰ªè¾‘ã€3Då»ºæ¨¡ã€æ¸¸æˆå¼€å‘â€¦â€¦ğŸ˜‹
                                            </p>
                                            <p class="md:text-lg text-sm">
                                                æ„¿æœ‰å¿—è€…ä¸è´Ÿå°‘å¹´æ—¶ï¼Œä½ æ‰€çƒ­çˆ±çš„ï¼Œå°±æ˜¯ä½ çš„ç”Ÿæ´»ğŸ¤“
                                            </p>
                                </div>
                            </div>
                        </template>
                    </macWindow>
                    <macWindow border class="md:!h-full h-64 w-full">
                        <template #TR>
                            <div class="flex-1" />
                            <outlineText text="GitHubä¸»é¡µ" bottomLineClass="!mt-0" class="hover:text-[#119DEC] md:text-[#FEFCE4] text-[#119DEC]
                            transition-colors duration-300 pb-2 md:pb-0" lineColor="#119DEC" transitionLineColor
                                :keepInEnd="isMobile" @click="openInNewTab('https://github.com/seeleclover')">
                                <ExternalLink class="size-4 translate-y-0.5" />
                            </outlineText>
                        </template>
                        <template #main>
                            <div class="flex-1 flex items-center">
                                <div class="flex h-full flex-col items-center justify-center
                                space-y-4 border-r-1 border-r-[#595959] px-4">
                                    <img src="/src/assets/å¼€å‘è€…å¤´åƒ/Seele.Clover.png" alt=""
                                        class="md:size-24 size-16 rounded-full">
                                    <p class="md:text-2xl text-lg whitespace-nowrap overflow-ellipsis">Seele.Clover</p>
                                </div>
                                <div class="flex-1 h-full flex items-center ml-4 min-w-1/3">
                                    <p class="md:text-lg text-sm">
                                        ä»–ä¸åªæ˜¯è¯´æ•…äº‹çš„äººï¼Œä¹Ÿæ˜¯æ•…äº‹ã€‚è€Œä¸”è¿™ä¸ªæ•…äº‹å……æ»¡æ´»åŠ›ï¼Œåƒå˜ä¸‡åŒ–ï¼Œæ°¸å‚ä¸æœ½ã€‚
                                    </p>
                                </div>
                            </div>
                        </template>
                    </macWindow>
                    <macWindow border class="md:!h-full h-64 w-full">
                        <template #TR>
                            <div class="flex-1" />
                            <outlineText text="GitHubä¸»é¡µ" bottomLineClass="!mt-0" class="hover:text-[#119DEC] md:text-[#FEFCE4] text-[#119DEC]
                            transition-colors duration-300 pb-2 md:pb-0" lineColor="#119DEC" transitionLineColor
                                :keepInEnd="isMobile" @click="openInNewTab('https://github.com/xl-xlxl')">
                                <ExternalLink class="size-4 translate-y-0.5" />
                            </outlineText>
                        </template>
                        <template #main>
                            <div class="flex-1 flex items-center">
                                <div class="flex h-full flex-col items-center justify-center
                                space-y-4 border-r-1 border-r-[#595959] px-4">
                                    <img src="/src/assets/å¼€å‘è€…å¤´åƒ/xl-xlxl.jpg" alt="" class="md:size-24 size-16 rounded-full">
                                    <p class="md:text-2xl text-lg whitespace-nowrap overflow-ellipsis">xl-xlxl</p>
                                </div>
                                <div class="flex-1 h-full flex flex-col justify-center ml-4 min-w-1/3">
                                    <p class="md:text-lg text-sm break-all">
                                        ç¬¬4å±Š GDMU-ACM å‰¯ä¼šé•¿ï¼Œå…¨æ ˆé¼ é¼ ğŸ˜¨ 
                                        æ•²ä»£ç æ˜¯è¢«è¿«çš„ï¼Œå†™æ–‡æ¡£æ˜¯æ‘†çƒ‚çš„ï¼Œæ­åšå®¢æ˜¯åœæ»çš„ğŸ«¡ åŠŸèƒ½ä¸æ–­è¿­ä»£ï¼Œbugå±‚å‡ºä¸ç©·ğŸ˜†
                                        äººç”Ÿåœ¨ä¸–ï¼Œä¸è¿‡å’–å•¡å› ç»­å‘½â˜• å¥½åœ¨å¤´å‘è¿˜åœ¨ï¼Œè¿˜èƒ½å†ç†¬ä¸€æ™šğŸ‡ 
                                    </p>
                                    <p class="md:text-lg text-sm">
                                        # è°·å­ # å‘¨è¾¹ # çˆ±é—¨ # å¤§èƒƒè¢‹
                                    </p>
                                    <p class="md:text-lg text-sm">
                                        æ¸¸äº‘æ‹‚é£ï¼ŒèŠ±æŸ“æ¹›ç©º ~ â™ª â™¥ 
                                    </p>
                                </div>
                            </div>
                        </template>
                    </macWindow>
                </div>
            </div>
        </section>
        <!-- Section 6 -->
        <section class="bg-gray-200 dark:bg-[#0E100F]">
            <div class="xl:pt-36 md:pt-24 pt-16">
                <!-- section ä¸»å†…å®¹ -->
                <h1 class="md:text-6xl text-4xl text-center font-bold">è‡´è°¢åå•</h1>
                <div class="md:space-y-8 space-y-4 md:mt-10 mt-5 md:mx-6 mx-4 text-center md:text-3xl text-lg font-bold text-emerald-400">
                    <p>æ„Ÿè°¢ ç½‘åä¼ å¥‡è€ç¥– æä¾›çš„æœåŠ¡å™¨ä¸åŸŸåæ”¯æŒâœ¨</p>
                    <p>æ„Ÿè°¢ ç½‘åâ€œç”»ä¹‹æ‰§æ”¿â€è›‹æ€» æä¾›çš„å‰ç¥¥ç‰©ç´ æâœ¨</p>
                    <p>æ„Ÿè°¢ é»å¤§ä¼šé•¿ æä¾›çš„åè°ƒä¿éšœæœåŠ¡âœ¨</p>
                    <p>æ„Ÿè°¢ ç«ç«å¤§ç‹ æä¾›çš„æ–°ç‰ˆACM LOGOâœ¨</p>
                    <p>æ„Ÿè°¢æ‰€æœ‰ä¸ºåä¼šäº‹åŠ¡é»˜é»˜ä»˜å‡ºçš„æˆå‘˜ï¼Œä»¥åŠæ‰€æœ‰ä¸ºæœ¬é¡¹ç›®æä¾›æŠ€æœ¯æ”¯æŒçš„å¼€æºé¡¹ç›®è´¡çŒ®è€…âœ¨</p>
                </div>
            </div>
        </section>
    </div>
</template>
<script setup lang="ts">

import { computed, onMounted, ref, onUnmounted, onBeforeMount, watch, nextTick } from 'vue';

// å¯¼å…¥ç»„ä»¶
import matrix from '@/components/introduction/matrix.vue';
import macWindow from '@/components/introduction/macWindow.vue';
import titleBlock from '@/components/introduction/titleBlock.vue';
import QA from '@/components/introduction/QA.vue';
import section4Terminal from '@/components/introduction/section4Terminal.vue';
import section1Left from '@/components/introduction/section1Left.vue';
import section1Right from '@/components/introduction/section1Right.vue';
import scrollHint from '@/components/scrollHint.vue';

import { outlineText } from '@/components/ui/text';

// å¯¼å…¥å›¾æ ‡
import {
    BrainCircuit,
    Puzzle,
    Satellite,
    ChevronsUp,
    ChevronsDown,
    ExternalLink
} from 'lucide-vue-next';

// å¯¼å…¥ Lottie åŠ¨ç”»åº“
import lottie from 'lottie-web'

// å¯¼å…¥åŠ¨ç”»æ•°æ®
import Webdesign from '@/assets/MGåŠ¨ç”»æ–‡ä»¶/Webdesign.json';
import programmingLottie from '@/assets/MGåŠ¨ç”»æ–‡ä»¶/programming.json';

// å¯¼å…¥ GSAP åŠå…¶æ’ä»¶
import { gsap } from "gsap"
import { ScrollTrigger } from "gsap/ScrollTrigger";

// å¯¼å…¥åŠ¨ç”»æœåŠ¡
import { Animation } from '@/services'

import { openInNewTab } from '@/lib/utils';

import { useSystemStore } from '@/stores/system';
import { storeToRefs } from 'pinia';

const systemStore = useSystemStore();
const { forceToggleTheme } = systemStore;
const { isDesktop, isXlDesktop, isMobile } = storeToRefs(systemStore);

const introPageRoot = ref<HTMLElement | null>(null);

const section1 = ref<HTMLElement | null>(null);
const setion1_width = ref<number>(0);
const setion1_height = ref<number>(0);

const lottieContainerA = ref<HTMLElement | null>(null);
const lottieContainerB = ref<HTMLElement | null>(null);

const cat_smile = ref<HTMLImageElement | null>(null);
const fish_smile = ref<HTMLImageElement | null>(null);

const section3_scrollMain = ref<HTMLElement | null>(null);
const section3_scrollContainer = ref<HTMLElement | null>(null);

let animationSys: Animation | null = null;

const section2_title_1 = ref<HTMLElement | null>(null);

const section2_dynamicTitleIndex = ref<number>(0)

const section2_dynamicTitle_1 = ref<HTMLElement | null>(null);
const section2_dynamicTitle_2 = ref<HTMLElement | null>(null);
const section2_dynamicTitle_3 = ref<HTMLElement | null>(null);
const section2_dynamicTitleArray = [
    section2_dynamicTitle_1,
    section2_dynamicTitle_2,
    section2_dynamicTitle_3
];

const section3_main = ref<HTMLElement | null>(null);

const section3_scrollProgress = ref<number>(0)
const section3_scrollLength = ref<number>(0);
const section3_scrollVelocity = ref<number>(0);

const section3_PTag = ref<HTMLElement | null>(null)
const section3_progressBlock = ref<HTMLElement | null>(null);
const section3_progressDivs = ref<HTMLElement | null>(null);

const section3_cards = ref<HTMLElement | null>(null);
const section3_cards_toggle = ref<HTMLElement | null>(null);

function handleResize() {
    setion1_width.value = section1.value!.clientWidth + 100
    setion1_height.value = section1.value!.clientHeight + 500;
}

onMounted(() => {
    // çŸ©é˜µèƒŒæ™¯åˆå§‹åŒ–
    if (section1.value) {
        setion1_width.value = section1.value.clientWidth + 100;
        setion1_height.value = section1.value.clientHeight + 500;
    }
    window.addEventListener('resize', handleResize)
    if (isXlDesktop.value) {
        // è®¾ç½® Lottie åŠ¨ç”»
        lottie.loadAnimation({
            container: lottieContainerA.value!,
            renderer: 'svg',
            loop: true,
            autoplay: true,
            animationData: Webdesign,
        })
        lottie.loadAnimation({
            container: lottieContainerB.value!,
            renderer: 'svg',
            loop: true,
            autoplay: true,
            animationData: programmingLottie,
        })
    }
    // æ»šåŠ¨è§†å·®æ•ˆæœ
    animationSys = new Animation()
    animationSys.smootherEffects(
        [lottieContainerA, lottieContainerB, cat_smile, fish_smile],
        { speed: 1.2 }
    )
    // åˆå§‹åŒ– GSAP åŠ¨ç”»
    initAnimate()
    if (isMobile.value) {
        section3CardsManager.init()
    }
    nextTick(() => ScrollTrigger.refresh())
})

let horizontalScrollTrigger: ScrollTrigger | null = null

// ç›‘å¬ isDesktop å˜åŒ–
watch(isXlDesktop, async (newVal, oldVal) => {
    if (newVal !== oldVal) {
        await nextTick()
        // é‡æ–°åˆå§‹åŒ–åŠ¨ç”»
        reinitializeAnimations()
    }
}, { immediate: false })

onBeforeMount(() => {
    forceToggleTheme('dark')
})

const section3_scrollLengthProgressPx = computed(() => {
    return `[${(section3_scrollLength.value * section3_scrollProgress.value).toFixed(2)}px / ${section3_scrollLength.value}.00px]`
})

const section3_scrollProgressPercent = computed(() => {
    return `${(section3_scrollProgress.value * 100).toFixed(2)}%`
})

const section3_progressText = computed(() => {
    const progress = section3_scrollProgress.value;
    if (progress < 1) {
        return 'STACK INITIALIZING...'
    } else {
        return 'Complete!'
    }
});

function initAnimate() {
    createHorizontalScroll()
    // è½®æ¢ title åˆå§‹åŒ–æ ·å¼
    gsap.set(
        section2_dynamicTitleArray.map(item => item.value),
        {
            opacity: 0,
            y: '100%'
        }
    )
    // è°ƒç”¨è½®æ¢ title åŠ¨ç”»
    if (section2_title_1.value) {
        ScrollTrigger.create({
            trigger: section2_title_1.value,
            start: "bottom bottom",
            once: true,
            onEnter: () => section2_dynamicTitleAnimation(section2_dynamicTitleIndex.value)
        });
    }
    const section3_blocks = section3_main.value!.querySelectorAll(".title-block")
    gsap.set(section3_blocks, {
        autoAlpha: 0,
        y: '50%',
        filter: "blur(4px)"
    })
    section3_titleAnimation(section3_blocks as any);
    if (isDesktop.value) {
        gsap.set(section3_progressDivs.value, {
            y: '-100%',
            autoAlpha: 0
        })
        const section3_scrollListenLength = section3_scrollLength.value - section3_PTag.value!.clientWidth
        ScrollTrigger.create({
            trigger: section3_scrollMain.value,
            start: "top top",
            end: () => `+=${section3_scrollListenLength}`,
            onUpdate: (self) => {
                if (!section3_progressDivs.value) return
                const velocity = self.getVelocity();
                section3_scrollProgress.value = self.progress;
                section3_progressBlock.value!.style.clipPath = `inset(0 ${100 - self.progress * 100}% 0 0)`;
                if (velocity > 2 || velocity < -2) {
                    section3_scrollVelocity.value = Math.abs(Number(velocity.toFixed(2)));
                } else {
                    section3_scrollVelocity.value = 0;
                }
            },
            onLeave: () => {
                section3_scrollVelocity.value = 0
            },
            onLeaveBack: () => {
                section3_scrollVelocity.value = 0
                gsap.to(section3_progressDivs.value, {
                    y: '-100%',
                    autoAlpha: 0,
                    duration: 0.5,
                    ease: "power3.out",
                })
            },
            onEnter: () => {
                gsap.to(section3_progressDivs.value, {
                    y: 0,
                    autoAlpha: 1,
                    duration: 0.5,
                    ease: "power3.out"
                })
            },
            onEnterBack: () => {

            }
        })
    }
}

// è½®æ¢ title åŠ¨ç”»
function section2_dynamicTitleAnimation(index: number) {
    const el = section2_dynamicTitleArray[index].value;
    const tl = gsap.timeline()
    if (!el) return;
    tl.fromTo(
        el,
        {
            opacity: 0,
            y: '100%',
            filter: "blur(4px)",
        },
        {
            opacity: 1,
            y: 0,
            filter: "blur(0px)",
            duration: 0.3,
            ease: "power1.out"
        }
    )
    tl.to(
        el,
        {
            opacity: 0,
            y: '-100%',
            duration: 0.3,
            filter: "blur(4px)",
            ease: "power1.in",
            delay: 2,
            onComplete: () => {
                section2_dynamicTitleIndex.value = (section2_dynamicTitleIndex.value + 1) % section2_dynamicTitleArray.length;
                section2_dynamicTitleAnimation(section2_dynamicTitleIndex.value);
            }
        }
    )
}

function section3_titleAnimation(els: NodeListOf<HTMLElement>) {
    els.forEach((el) => {
        ScrollTrigger.create({
            trigger: el,
            start: "bottom bottom",
            once: true,
            onEnter: () => {
                gsap.to(el, {
                    autoAlpha: 1,
                    filter: "blur(0px)",
                    y: 0,
                    ease: "power3.out",
                    duration: 0.5
                })
            }
        })
    })
}

const section3CardsManager = {
    height: 0,
    isPackUp: ref(true),
    isExpand: ref(false),
    init() {
        const top = section3_cards.value!.getBoundingClientRect().top
        const thirdChild = section3_cards.value!.children[2]
        const bottom = thirdChild?.getBoundingClientRect().bottom
        this.height = bottom - top + 16
        gsap.set(section3_cards.value, {
            height: this.height
        })
        gsap.set(section3_cards_toggle.value!.children[1], {
            autoAlpha: 0
        })
    },
    expandCards() {
        gsap.to(section3_cards.value, {
            height: 'auto',
            ease: "power2.inOut",
            duration: 1
        })
        gsap.fromTo(
            section3_cards_toggle.value!.children[0],
            {
                autoAlpha: 1,
                y: 0
            },
            {
                autoAlpha: 0,
                y: '150%',
                duration: 0.5,
                ease: "power2.inOut"
            }
        )
        gsap.fromTo(
            section3_cards_toggle.value!.children[1],
            {
                autoAlpha: 0,
                y: '-150%'
            },
            {
                autoAlpha: 1,
                y: 0,
                duration: 0.5,
                ease: "power2.inOut"
            }
        )
    },
    collapseCards() {
        gsap.to(section3_cards.value, {
            height: this.height,
            ease: "power2.inOut",
            duration: 1
        })
        gsap.fromTo(
            section3_cards_toggle.value!.children[1],
            {
                autoAlpha: 1,
                y: 0
            },
            {
                autoAlpha: 1,
                y: '-150%',
                duration: 0.5,
                ease: "power2.inOut"
            }
        )
        gsap.fromTo(
            section3_cards_toggle.value!.children[0],
            {
                autoAlpha: 0,
                y: '150%'
            },
            {
                autoAlpha: 1,
                y: 0,
                duration: 0.5,
                ease: "power2.inOut"
            }
        )
        gsap.to(window, {
            duration: 1,
            ease: "power2.inOut",
            scrollTo: {
                y: section3_cards.value!,
                offsetY: 56,
                autoKill: false
            }
        })
    },
    toggleStatus() {
        if (this.isPackUp.value) {
            this.expandCards()
            this.isPackUp.value = false
            this.isExpand.value = true
        } else {
            this.collapseCards()
            this.isPackUp.value = true
            this.isExpand.value = false
        }
    }
}

function createHorizontalScroll() {
    if (!isXlDesktop.value || !section3_scrollContainer.value) return

    const scrollContainer = section3_scrollContainer.value
    const totalWidth = scrollContainer.scrollWidth
    const clientWidth = scrollContainer.clientWidth
    section3_scrollLength.value = totalWidth - clientWidth

    horizontalScrollTrigger = ScrollTrigger.create({
        trigger: section3_scrollMain.value,
        start: "top top",
        end: () => `+=${section3_scrollLength.value}`,
        pin: true,
        scrub: true,
        anticipatePin: 1,
        animation: gsap.to(scrollContainer, {
            x: -section3_scrollLength.value,
            ease: "none"
        })
    })
}

function destroyHorizontalScroll() {
    if (horizontalScrollTrigger) {
        horizontalScrollTrigger.kill()
        horizontalScrollTrigger = null
    }
    // é‡ç½®å®¹å™¨ä½ç½®
    if (section3_scrollContainer.value) {
        // gsap.set(section3_scrollContainer.value, { x: 0 })
    }
}

function reinitializeAnimations() {
    // é”€æ¯æ—§çš„åŠ¨ç”»
    destroyHorizontalScroll()
    // é‡æ–°åˆ›å»ºåŠ¨ç”»
    if (isXlDesktop.value) {
        createHorizontalScroll()
    }
    // åˆ·æ–° ScrollTrigger
    ScrollTrigger.refresh()
}

onUnmounted(() => {
    destroyHorizontalScroll()
    ScrollTrigger.getAll().forEach(trigger => trigger.kill())
    window.removeEventListener('resize', handleResize)
})


</script>

<style scoped>
@import './index.css';
</style>
